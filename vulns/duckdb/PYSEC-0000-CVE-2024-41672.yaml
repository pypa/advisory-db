id: PYSEC-0000-CVE-2024-41672
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
details: DuckDB is a SQL database management system. In versions 1.0.0 and prior,
  content in filesystem is accessible for reading using `sniff_csv`, even with `enable_external_access=false`.
  This vulnerability provides an attacker with access to filesystem even when access
  is expected to be disabled and other similar functions do NOT provide access. There
  seem to be two vectors to this vulnerability. First, access to files that should
  otherwise not be allowed. Second, the content from a file can be read (e.g. `/etc/hosts`,
  `proc/self/environ`, etc) even though that doesn't seem to be the intent of the
  sniff_csv function. A fix for this issue is available in commit c9b7c98aa0e1cd7363fe8bb8543a95f38e980d8a
  and is expected to be part of version 1.1.0.
affected:
- package:
    name: duckdb
    ecosystem: PyPI
    purl: pkg:pypi/duckdb
  ranges:
  - type: GIT
    repo: https://github.com/duckdb/duckdb
    events:
    - introduced: "0"
    - fixed: c9b7c98aa0e1cd7363fe8bb8543a95f38e980d8a
    - fixed: c9b7c98aa0e1cd7363fe8bb8543a95f38e980d8a
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 1.1.0
references:
- type: ADVISORY
  url: https://github.com/duckdb/duckdb/security/advisories/GHSA-w2gf-jxc9-pf2q
- type: EVIDENCE
  url: https://github.com/duckdb/duckdb/security/advisories/GHSA-w2gf-jxc9-pf2q
- type: FIX
  url: https://github.com/duckdb/duckdb/commit/c9b7c98aa0e1cd7363fe8bb8543a95f38e980d8a
- type: FIX
  url: https://github.com/duckdb/duckdb/pull/13133
aliases:
- CVE-2024-41672
related:
- GHSA-w2gf-jxc9-pf2q
- GHSA-w2gf-jxc9-pf2q
modified: "2024-11-21T09:32:56Z"
published: "2024-07-24T18:15:05Z"
