id: PYSEC-0000-CVE-2024-24560
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
details: Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine.
  When calls to external contracts are made, we write the input buffer starting at
  byte 28, and allocate the return buffer to start at byte 0 (overlapping with the
  input buffer). When checking RETURNDATASIZE for dynamic types, the size is compared
  only to the minimum allowed size for that type, and not to the returned value's
  length. As a result, malformed return data can cause the contract to mistake data
  from the input buffer for returndata.  When the called contract returns invalid
  ABIv2 encoded data, the calling contract can read different invalid data (from the
  dirty buffer) than the called contract returned.
affected:
- package:
    name: vyper
    ecosystem: PyPI
    purl: pkg:pypi/vyper
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 0.4.0b1
references:
- type: EVIDENCE
  url: https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686
- type: ADVISORY
  url: https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686
aliases:
- CVE-2024-24560
- GHSA-gp3w-2v2m-p686
modified: "2024-02-12T15:23:00Z"
published: "2024-02-02T17:15:00Z"
