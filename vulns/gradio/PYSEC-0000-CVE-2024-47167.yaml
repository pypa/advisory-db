id: PYSEC-0000-CVE-2024-47167
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
details: Gradio is an open-source Python package designed for quick prototyping. This
  vulnerability relates to **Server-Side Request Forgery (SSRF)** in the `/queue/join`
  endpoint. Gradioâ€™s `async_save_url_to_cache` function allows attackers to force
  the Gradio server to send HTTP requests to user-controlled URLs. This could enable
  attackers to target internal servers or services within a local network and possibly
  exfiltrate data or cause unwanted internal requests. Additionally, the content from
  these URLs is stored locally, making it easier for attackers to upload potentially
  malicious files to the server. This impacts users deploying Gradio servers that
  use components like the Video component which involve URL fetching. Users are advised
  to upgrade to `gradio>=5` to address this issue.  As a workaround, users can disable
  or heavily restrict URL-based inputs in their Gradio applications to trusted domains
  only. Additionally, implementing stricter URL validation (such as allowinglist-based
  validation) and ensuring that local or internal network addresses cannot be requested
  via the `/queue/join` endpoint can help mitigate the risk of SSRF attacks.
affected:
- package:
    name: gradio
    ecosystem: PyPI
    purl: pkg:pypi/gradio
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 5.0.0
references:
- type: ADVISORY
  url: https://github.com/gradio-app/gradio/security/advisories/GHSA-576c-3j53-r9jj
aliases:
- CVE-2024-47167
- GHSA-576c-3j53-r9jj
modified: "2024-10-17T16:53:29Z"
published: "2024-10-10T22:15:11Z"
