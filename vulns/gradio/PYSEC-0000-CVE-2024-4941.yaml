id: PYSEC-0000-CVE-2024-4941
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
details: A local file inclusion vulnerability exists in the JSON component of gradio-app/gradio
  version 4.25. The vulnerability arises from improper input validation in the `postprocess()`
  function within `gradio/components/json_component.py`, where a user-controlled string
  is parsed as JSON. If the parsed JSON object contains a `path` key, the specified
  file is moved to a temporary directory, making it possible to retrieve it later
  via the `/file=..` endpoint. This issue is due to the `processing_utils.move_files_to_cache()`
  function traversing any object passed to it, looking for a dictionary with a `path`
  key, and then copying the specified file to a temporary directory. The vulnerability
  can be exploited by an attacker to read files on the remote system, posing a significant
  security risk.
affected:
- package:
    name: gradio
    ecosystem: PyPI
    purl: pkg:pypi/gradio
  ranges:
  - type: GIT
    repo: https://github.com/gradio-app/gradio
    events:
    - introduced: "0"
    - fixed: ee1e2942e0a1ae84a08a05464e41c8108a03fa9c
    - fixed: ee1e2942e0a1ae84a08a05464e41c8108a03fa9c
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 4.31.4
references:
- type: EVIDENCE
  url: https://huntr.com/bounties/39889ce1-298d-4568-aecd-7ae40c2ca58e
- type: FIX
  url: https://github.com/gradio-app/gradio/commit/ee1e2942e0a1ae84a08a05464e41c8108a03fa9c
- type: WEB
  url: https://huntr.com/bounties/39889ce1-298d-4568-aecd-7ae40c2ca58e
aliases:
- CVE-2024-4941
modified: "2024-11-21T09:43:54Z"
published: "2024-06-06T18:15:18Z"
